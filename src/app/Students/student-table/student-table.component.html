<div *ngIf="isLoggedIn">
  <app-navbar></app-navbar>
  <div class="container">

    <ng-template #content let-modal >
      <div class="modal-header">
        <h4 class="modal-title">Add Student</h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')" ></button>
      </div>
      <div class="modal-body">
        <app-add-student (studentAdded)="UpdateTable($event)"></app-add-student>
      </div>
    </ng-template>
    
   
  
    <!-- <ng-template #edit let-modal>
      <div class="modal-header">
        <h4 class="modal-title">Edit Student</h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')" ></button>
      </div>
      <div class="modal-body">
        <app-add-student (studentAdded)="UpdateTable($event)"></app-add-student>
      </div>
    </ng-template> -->


    <div class="container mt-4">
    

      <form (ngSubmit)="searchStudents()">
        <div>
          <label>Name</label>
          <div class="input-group mb-3">
            <input type="text" class="form-control" [(ngModel)]="searchDto.name" name="name" placeholder="Search Name">
          </div>
          <label>Age From</label>
          <div class="input-group mb-3">
            <input type="number" class="form-control" [(ngModel)]="searchDto.ageFrom" name="ageFrom" placeholder="Age From">
          </div>
          <label>Age To</label>
          <div class="input-group mb-3">
            <input type="number" class="form-control" [(ngModel)]="searchDto.ageTo" name="ageTo" placeholder="Age To">
          </div>
          <label>Country</label>
          <div class="input-group mb-3">
            <input type="text" class="form-control" [(ngModel)]="searchDto.country" name="country" placeholder="Country">
          </div>
         
          <div>
            <label>Gender</label>
            <select [(ngModel)]="searchDto.gender" class="form-control" name="gender" >
             
              <option value="Male">Male</option>
              <option value="Female">Female</option>
            </select>
          </div><br/>
        </div>
        <div class="input-group-append text-end">
          <button class="btn btn-primary"  type="submit">Search</button>
          <button class="btn btn-warning"  (click)="reset()">Reset</button>
        </div>
      </form>
      <i class="material-icons bg-success text-white fs-2 rounded-2" (click)="openXl(content, null)">add</i>
      <table class="table table-striped">
        <thead>
          <tr>
            
            <th> First Name<i class="material-icons sort-icon" (click)="sortData('firstName')">unfold_more</i></th>
            <th> Last Name<i class="material-icons sort-icon" (click)="sortData('lastName')">unfold_more</i></th>
            <th> Email<i class="material-icons sort-icon" (click)="sortData('email')">unfold_more</i></th>
            <th> Gender<i class="material-icons sort-icon" (click)="sortData('gender')">unfold_more</i></th>
            <th> Birth Date<i class="material-icons sort-icon" (click)="sortData('birthDate')">unfold_more</i></th>
            <th> Country<i class="material-icons sort-icon" (click)="sortData('country')">unfold_more</i></th>
            <th>Actions</th>
            
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="students.length === 0">
            <td colspan="7" class="no-students-message text-danger">
              No students found.
            </td>
          </tr>
          <tr *ngFor="let student of students">
            <td>{{ student.firstName }}</td>
            <td>{{ student.lastName }}</td>
            <td>{{ student.email }}</td>
            <td>{{ student.gender }}</td>
            <td>{{ student.birthDate | age }}</td>
            <td>{{ student.country }}</td>
            <td>
              <i class="material-icons text-info" (click)="show(student.id)">visibility</i>
              <i class="material-icons text-danger" (click)="delete(student.id)">delete</i>
              <i class="material-icons text-warning"  (click)="openEditModal(student)">edit</i> 
              
            </td>
          </tr>
        </tbody>
      </table>

      <ngb-pagination [collectionSize]="totalItems" [(page)]="pageIndex" [pageSize]="pageSize" (pageChange)="onPageChange($event)">
      </ngb-pagination>
      <div class="pagination-controls">
        <button class="btn btn-outline-secondary" (click)="goToFirstPage()">First Page</button>
        <button class="btn btn-outline-secondary" (click)="goToLastPage()">Last Page</button>
      </div>

      <div class="form-group">
        <label for="pageSize">Entries per page:</label>
        <select id="pageSize" class="form-control" [(ngModel)]="pageSize" (change)="onPageSizeChange()">
          <option *ngFor="let size of [10, 20, 30, 40, 50]" [value]="size">{{ size }}</option>
        </select>
      </div>
      <div>Total Items: {{ totalItems }}</div>
      <div>{{ getCurrentRange() }}</div>

    </div>

  </div>
</div>
